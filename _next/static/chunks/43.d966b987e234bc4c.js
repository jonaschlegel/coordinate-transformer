"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[43],{3043:(e,t,r)=>{r.r(t),r.d(t,{default:()=>w});var s=r(2432),a=r(364),l=r(5895),o=r.n(l);r(8618),r(4760),r(4393),r(3770);var n=r(1194),i=r(3881),c=r(8695),d=r(7227),u=r(8698),m=r(1544),p=r(1572),h=r(7254),x=r(1586),f=r(1315);let g={"plaats/settlement":"#1f77b4","eiland/island":"#ff7f0e","rivier/river":"#2ca02c","kaap/cape":"#9467bd","landstreek/region":"#7f7f7f","baai/bay":"#8c564b","eilanden/islands":"#ff8c42","fort/fortress":"#aec7e8","berg/mountain":"#d62728","ondiepte/shoals":"#98df8a","zeestraat/strait":"#17becf","provincie/province":"#c5b0d5","rif/reef":"#ffbb78","wijk/town district":"#bcbd22","klip/cliff":"#8c564b","schiereiland/peninsula":"#e377c2","gebouw/building":"#ff9896","inham/inlet":"#17becf","lagune/lagoon":"#98df8a","meer/lake":"#e377c2","zee/sea":"#17becf","fort/fortification":"#aec7e8","weg/road":"#ffbb78","bron/spring, well":"#98df8a","klooster/monastery":"#ff9896","ru\xefne/ruin":"#c5b0d5",unknown:"#bcbd22"},b={osm:{name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'},satellite:{name:"Satellite",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:'&copy; <a href="https://www.esri.com/">Esri</a>'},terrain:{name:"Terrain",url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://opentopomap.org/">OpenTopoMap</a>'}},v="#333333",y=(e,t)=>{let r=t?"16px":"12px";return o().divIcon({html:'<span style="background-color: '.concat(e,"; width: ").concat(r,"; height: ").concat(r,"; border-radius: 50%; display: inline-block; border: ").concat(t?"3px solid #0ea5e9":"1px solid white","; box-shadow: ").concat(t?"0 0 8px rgba(14, 165, 233, 0.7)":"0 0 2px rgba(0,0,0,0.5)",'; transition: all 0.2s ease-in-out;"></span>'),className:"custom-div-icon ".concat(t?"selected-marker-icon":""),iconSize:t?[16,16]:[12,12],iconAnchor:t?[8,8]:[6,6]})};delete o().Icon.Default.prototype._getIconUrl,o().Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});let w=e=>{let{points:t,selectedPointId:r,onPointSelect:l}=e,w=(0,a.useRef)(null),j=(0,a.useRef)(null),N=(0,a.useRef)(null),k=(0,a.useRef)(null),[C,z]=(0,a.useState)(!1),[L,S]=(0,a.useState)(!0),[E,O]=(0,a.useState)(!0),[A,I]=(0,a.useState)("osm"),[P,T]=(0,a.useState)(!0),[M,B]=(0,a.useState)({totalPoints:0,visiblePoints:0,categories:0}),V=(0,a.useRef)({}),[D,R]=(0,a.useState)({}),U=e=>{if(j.current&&b[e]){let t=b[e];j.current.eachLayer(e=>{if(e instanceof o().TileLayer){var t;null===(t=j.current)||void 0===t||t.removeLayer(e)}}),o().tileLayer(t.url,{attribution:t.attribution}).addTo(j.current),I(e)}};return(0,a.useEffect)(()=>{let e=t.length;B({totalPoints:e,visiblePoints:Object.keys(V.current).length,categories:Object.keys(D).length})},[t,D]),(0,a.useEffect)(()=>{if(!t||0===t.length){R({});return}let e=Array.from(new Set(t.map(e=>e.category&&e.category.trim()?e.category:""))).filter(Boolean).sort(),r={},s=new Set;e.forEach(e=>{let t=g[e.toLowerCase()];t&&!s.has(t)&&(r[e]={color:t},s.add(t))});let a=0;e.forEach(e=>{if(!r[e]){let t,l=0;do{let e=(137.508*a+15*l)%360;t="hsl(".concat(Math.floor(e),", 70%, 50%)"),l++}while(s.has(t)&&l<25);s.has(t)&&(t="hsl(".concat(Math.floor(360*Math.random()),", 70%, 60%)")),r[e]={color:t},s.add(t),a++}}),R(r)},[t]),(0,a.useEffect)(()=>{if(!w.current||j.current)return;O(!0),j.current=o().map(w.current,{center:[20,0],zoom:2,attributionControl:!1,zoomControl:!1}),o().control.attribution({prefix:'<a href="https://leafletjs.com">Leaflet</a>',position:"bottomleft"}).addTo(j.current);let e=b[A];return o().tileLayer(e.url,{attribution:e.attribution}).addTo(j.current),N.current=o().markerClusterGroup({chunkedLoading:!0,maxClusterRadius:60,showCoverageOnHover:!1,zoomToBoundsOnClick:!0,spiderfyOnMaxZoom:!0,removeOutsideVisibleBounds:!0}),j.current.addLayer(N.current),setTimeout(()=>{O(!1),z(!0)},500),()=>{var e;k.current&&j.current&&j.current.removeControl(k.current),null===(e=j.current)||void 0===e||e.remove(),j.current=null,N.current=null,z(!1),O(!0)}},[]),(0,a.useEffect)(()=>{if(!C||!j.current)return;let e=j.current;k.current&&e.removeControl(k.current);let t=Object.keys(D).sort();if(t.length>0){let r=new(o()).Control({position:"bottomright"});r.onAdd=()=>{let e=o().DomUtil.create("div","info legend leaflet-control-layers leaflet-control-layers-expanded");e.style.backgroundColor="rgba(255,255,255,0.9)",e.style.padding="6px 10px",e.style.borderRadius="5px",e.style.boxShadow="0 0 10px rgba(0,0,0,0.2)",e.style.maxWidth="180px";let r=o().DomUtil.create("div","",e);r.style.cursor="pointer",r.style.marginBottom=L?"6px":"0",r.style.fontWeight="bold",r.style.fontSize="13px",r.style.display="flex",r.style.justifyContent="space-between",r.style.alignItems="center",r.innerHTML='<span>Legend</span><span style="font-size: 1.1em;">'.concat(L?"&#9660;":"&#9654;","</span>");let s=o().DomUtil.create("div","",e);if(s.style.maxHeight="120px",s.style.overflowY="auto",s.style.display=L?"block":"none",o().DomEvent.disableClickPropagation(e),o().DomEvent.disableScrollPropagation(e),r.onclick=e=>{e.stopPropagation(),S(!L)},L){let e="";t.forEach(t=>{var r;let s=(null===(r=D[t])||void 0===r?void 0:r.color)||v;e+='<div style="display: flex; align-items: center; margin-bottom: 3px;"><span style="background-color: '.concat(s,'; width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 6px; border: 1px solid #ccc; flex-shrink: 0; box-shadow: 0 0 1px rgba(0,0,0,0.3);"></span><span style="font-size: 11px; word-break: break-word;">').concat(t,"</span></div>")}),s.innerHTML=e}return e},r.addTo(e),k.current=r}},[D,C,L,S]),(0,a.useEffect)(()=>{if(!C||!j.current||!N.current)return;let e=j.current,s=N.current;s.clearLayers(),V.current={};let a=[];if(t.forEach(e=>{let t=e.id===r,s=D[e.category],n=y((null==s?void 0:s.color)||v,t),i=o().marker([e.latitude,e.longitude],{icon:n});i.on("click",()=>l(e.id)),i.bindPopup('\n      <div style="font-family: sans-serif; font-size: 13px; max-width: 250px;">\n        <strong style="display: block; margin-bottom: 3px; font-size: 14px;">'.concat(e.originalName,"</strong>\n        <strong>Category:</strong> ").concat(e.category,"<br>\n        <strong>Original:</strong> ").concat(e.originalCoords,"<br>\n        <strong>Coords:</strong> ").concat(e.latitude.toFixed(4),", ").concat(e.longitude.toFixed(4),"\n      </div>\n    ")),i.bindTooltip("".concat(e.originalName," (").concat(e.category,")")),V.current[e.id]=i,a.push(i)}),a.length>0){if(s.addLayers(a),t.length>0&&(!e.getBounds().contains(s.getBounds())||3>e.getZoom()))try{let t=s.getBounds();t.isValid()&&e.fitBounds(t,{padding:[40,40],maxZoom:16})}catch(e){}}else e.setView([20,0],2)},[t,C,l,r,D]),(0,a.useEffect)(()=>{if(!C||!j.current)return;if(!r){j.current.closePopup();return}let e=V.current[r],s=j.current;if(e){var a;let l=e.getLatLng(),o=D[e.options.title||(null===(a=t.find(e=>e.id===r))||void 0===a?void 0:a.category)||"Unknown"],n=(null==o?void 0:o.color)||v;e.setIcon(y(n,!0)),N.current?N.current.zoomToShowLayer(e,()=>{s.setView(l,16),e.isPopupOpen()||e.openPopup()}):(s.setView(l,16),e.isPopupOpen()||e.openPopup())}Object.values(V.current).forEach(r=>{if(r!==e){let e=t.find(e=>V.current[e.id]===r);if(e){var s;let t=D[e.category],a=(null==t?void 0:t.color)||v;r.options.icon&&(null===(s=r.options.icon.options.className)||void 0===s?void 0:s.includes("selected-marker-icon"))&&r.setIcon(y(a,!1))}}})},[r,C,D,t]),(0,s.jsxs)("div",{className:"relative w-full h-full",children:[E&&(0,s.jsx)("div",{className:"absolute inset-0 bg-slate-100 z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.A,{className:"h-12 w-12 text-blue-600 mx-auto animate-pulse"}),(0,s.jsx)(i.A,{className:"absolute inset-0 h-12 w-12 text-blue-400 animate-spin"})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-slate-800",children:"Initializing Map"}),(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Loading geographic visualization..."})]})]})}),(0,s.jsx)("div",{ref:w,className:"w-full h-full"}),C&&!E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"absolute top-4 left-4 z-40 flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg shadow-lg px-3 py-2 border border-white/20",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 text-blue-600"}),(0,s.jsx)("span",{className:"font-medium text-slate-700",children:M.visiblePoints}),(0,s.jsx)("span",{className:"text-slate-500",children:"points"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(d.A,{className:"h-4 w-4 text-emerald-600"}),(0,s.jsx)("span",{className:"font-medium text-slate-700",children:M.categories}),(0,s.jsx)("span",{className:"text-slate-500",children:"categories"})]})]})}),(0,s.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg shadow-lg border border-white/20 overflow-hidden",children:(0,s.jsx)("div",{className:"flex",children:Object.entries(b).map(e=>{let[t,r]=e;return(0,s.jsx)("button",{onClick:()=>U(t),className:"px-3 py-2 text-xs font-medium transition-colors ".concat(A===t?"bg-blue-600 text-white":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"),title:"Switch to ".concat(r.name),children:r.name},t)})})})]}),(0,s.jsxs)("div",{className:"absolute top-4 right-4 z-40 flex flex-col space-y-2",children:[(0,s.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg shadow-lg border border-white/20 overflow-hidden",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("button",{onClick:()=>{j.current&&j.current.zoomIn()},className:"p-2 text-slate-600 hover:text-slate-800 hover:bg-slate-50 transition-colors border-b border-slate-200",title:"Zoom In",children:(0,s.jsx)(u.A,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>{j.current&&j.current.zoomOut()},className:"p-2 text-slate-600 hover:text-slate-800 hover:bg-slate-50 transition-colors border-b border-slate-200",title:"Zoom Out",children:(0,s.jsx)(m.A,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>{if(j.current&&N.current)try{let e=N.current.getBounds();e.isValid()?j.current.fitBounds(e,{padding:[20,20],maxZoom:16}):j.current.setView([20,0],2)}catch(e){j.current.setView([20,0],2)}},className:"p-2 text-slate-600 hover:text-slate-800 hover:bg-slate-50 transition-colors",title:"Reset View",children:(0,s.jsx)(p.A,{className:"h-4 w-4"})})]})}),(0,s.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg shadow-lg border border-white/20 overflow-hidden",children:(0,s.jsx)("button",{onClick:()=>{if(j.current&&N.current){let e=Object.values(V.current);P?(N.current.clearLayers(),e.forEach(e=>{var t;return null===(t=j.current)||void 0===t?void 0:t.addLayer(e)})):(e.forEach(e=>{var t;return null===(t=j.current)||void 0===t?void 0:t.removeLayer(e)}),N.current.addLayers(e)),T(!P)}},className:"p-2 transition-colors ".concat(P?"text-blue-600 bg-blue-50":"text-slate-600 hover:text-slate-800 hover:bg-slate-50"),title:P?"Disable Clustering":"Enable Clustering",children:P?(0,s.jsx)(h.A,{className:"h-4 w-4"}):(0,s.jsx)(x.A,{className:"h-4 w-4"})})})]}),t.length>0&&(0,s.jsx)("div",{className:"absolute bottom-4 left-4 right-4 z-40",children:(0,s.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg shadow-lg px-4 py-2 border border-white/20",children:(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 text-slate-500"}),(0,s.jsxs)("span",{className:"text-slate-600",children:[b[A].name," ","View"]})]}),(0,s.jsx)("div",{className:"h-4 w-px bg-slate-300"}),(0,s.jsxs)("div",{className:"text-slate-600",children:[P?"Clustered":"Individual"," markers"]})]}),(0,s.jsx)("div",{className:"text-slate-500",children:"Click markers for details â€¢ Drag to explore"})]})})}),0===t.length&&!E&&(0,s.jsx)("div",{className:"absolute inset-0 bg-slate-100/50 z-30 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center space-y-4 max-w-md mx-4",children:[(0,s.jsx)("div",{className:"p-3 bg-slate-100 rounded-full w-fit mx-auto",children:(0,s.jsx)(c.A,{className:"h-8 w-8 text-slate-400"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-slate-800",children:"No locations to display"}),(0,s.jsx)("p",{className:"text-sm text-slate-600",children:"Add some geographic data to see points on the map."})]})]})})]})]})}}}]);