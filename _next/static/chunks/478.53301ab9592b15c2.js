"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[478],{5478:(e,t,o)=>{o.r(t),o.d(t,{default:()=>u});var r=o(2432),n=o(364),a=o(5895),l=o.n(a);o(8618),o(4760),o(4393),o(3770);let i={"plaats/settlement":"#1f77b4","rivier/river":"#2ca02c","berg/mountain":"#d62728","eiland/island":"#ff7f0e","kaap/cape":"#9467bd","baai/bay":"#8c564b","meer/lake":"#e377c2","regio/region":"#7f7f7f","zee/sea":"#17becf","fort/fortification":"#aec7e8","weg/road":"#ffbb78","bron/spring, well":"#98df8a","klooster/monastery":"#ff9896","ru\xefne/ruin":"#c5b0d5",unknown:"#bcbd22"},c="#333333",s=(e,t)=>{let o=t?"16px":"12px";return l().divIcon({html:'<span style="background-color: '.concat(e,"; width: ").concat(o,"; height: ").concat(o,"; border-radius: 50%; display: inline-block; border: ").concat(t?"3px solid #0ea5e9":"1px solid white","; box-shadow: ").concat(t?"0 0 8px rgba(14, 165, 233, 0.7)":"0 0 2px rgba(0,0,0,0.5)",'; transition: all 0.2s ease-in-out;"></span>'),className:"custom-div-icon ".concat(t?"selected-marker-icon":""),iconSize:t?[16,16]:[12,12],iconAnchor:t?[8,8]:[6,6]})};delete l().Icon.Default.prototype._getIconUrl,l().Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"});let u=e=>{let{points:t,selectedPointId:o,onPointSelect:a}=e,u=(0,n.useRef)(null),d=(0,n.useRef)(null),p=(0,n.useRef)(null),f=(0,n.useRef)(null),[g,m]=(0,n.useState)(!1),[h,b]=(0,n.useState)(!0),y=(0,n.useRef)({}),[x,k]=(0,n.useState)({});return(0,n.useEffect)(()=>{if(!t||0===t.length){k({});return}let e=Array.from(new Set(t.map(e=>e.category))).sort(),o={},r=new Set;e.forEach(e=>{let t=i[e.toLowerCase()];t&&!r.has(t)&&(o[e]={color:t},r.add(t))});let n=0;e.forEach(e=>{if(!o[e]){let t,a=0;do{let e=(137.508*n+15*a)%360;t="hsl(".concat(Math.floor(e),", 70%, 50%)"),a++}while(r.has(t)&&a<25);r.has(t)&&(t="hsl(".concat(Math.floor(360*Math.random()),", 70%, 60%)")),o[e]={color:t},r.add(t),n++}}),k(o)},[t]),(0,n.useEffect)(()=>{if(u.current&&!d.current)return d.current=l().map(u.current,{center:[20,0],zoom:2,attributionControl:!1}),l().control.attribution({prefix:'<a href="https://leafletjs.com">Leaflet</a>',position:"bottomleft"}).addTo(d.current),l().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a>'}).addTo(d.current),p.current=l().markerClusterGroup({chunkedLoading:!0,maxClusterRadius:60}),d.current.addLayer(p.current),m(!0),()=>{var e;f.current&&d.current&&d.current.removeControl(f.current),null===(e=d.current)||void 0===e||e.remove(),d.current=null,p.current=null,m(!1)}},[]),(0,n.useEffect)(()=>{if(!g||!d.current)return;let e=d.current;f.current&&e.removeControl(f.current);let t=Object.keys(x).sort();if(t.length>0){let o=new(l()).Control({position:"bottomright"});o.onAdd=()=>{let e=l().DomUtil.create("div","info legend leaflet-control-layers leaflet-control-layers-expanded");e.style.backgroundColor="rgba(255,255,255,0.9)",e.style.padding="6px 10px",e.style.borderRadius="5px",e.style.boxShadow="0 0 10px rgba(0,0,0,0.2)",e.style.maxWidth="180px";let o=l().DomUtil.create("div","",e);o.style.cursor="pointer",o.style.marginBottom=h?"6px":"0",o.style.fontWeight="bold",o.style.fontSize="13px",o.style.display="flex",o.style.justifyContent="space-between",o.style.alignItems="center",o.innerHTML='<span>Legend</span><span style="font-size: 1.1em;">'.concat(h?"&#9660;":"&#9654;","</span>");let r=l().DomUtil.create("div","",e);if(r.style.maxHeight="120px",r.style.overflowY="auto",r.style.display=h?"block":"none",l().DomEvent.disableClickPropagation(e),l().DomEvent.disableScrollPropagation(e),o.onclick=e=>{e.stopPropagation(),b(!h)},h){let e="";t.forEach(t=>{var o;let r=(null===(o=x[t])||void 0===o?void 0:o.color)||c;e+='<div style="display: flex; align-items: center; margin-bottom: 3px;"><span style="background-color: '.concat(r,'; width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 6px; border: 1px solid #ccc; flex-shrink: 0; box-shadow: 0 0 1px rgba(0,0,0,0.3);"></span><span style="font-size: 11px; word-break: break-word;">').concat(t,"</span></div>")}),r.innerHTML=e}return e},o.addTo(e),f.current=o}},[x,g,h,b]),(0,n.useEffect)(()=>{if(!g||!d.current||!p.current)return;let e=d.current,r=p.current;r.clearLayers(),y.current={};let n=[];if(t.forEach(e=>{let t=e.id===o,r=x[e.category],i=s((null==r?void 0:r.color)||c,t),u=l().marker([e.latitude,e.longitude],{icon:i});u.on("click",()=>a(e.id)),u.bindPopup('\n      <div style="font-family: sans-serif; font-size: 13px; max-width: 250px;">\n        <strong style="display: block; margin-bottom: 3px; font-size: 14px;">'.concat(e.originalName,"</strong>\n        <strong>Category:</strong> ").concat(e.category,"<br>\n        <strong>Original:</strong> ").concat(e.originalCoords,"<br>\n        <strong>Coords:</strong> ").concat(e.latitude.toFixed(4),", ").concat(e.longitude.toFixed(4),"\n      </div>\n    ")),u.bindTooltip("".concat(e.originalName," (").concat(e.category,")")),y.current[e.id]=u,n.push(u)}),n.length>0){if(r.addLayers(n),t.length>0&&(!e.getBounds().contains(r.getBounds())||3>e.getZoom()))try{let t=r.getBounds();t.isValid()&&e.fitBounds(t,{padding:[40,40],maxZoom:16})}catch(e){}}else e.setView([20,0],2)},[t,g,a,o,x]),(0,n.useEffect)(()=>{if(!g||!d.current)return;if(!o){d.current.closePopup();return}let e=y.current[o],r=d.current;if(e){var n;let a=e.getLatLng(),l=x[e.options.title||(null===(n=t.find(e=>e.id===o))||void 0===n?void 0:n.category)||"Unknown"],i=(null==l?void 0:l.color)||c;e.setIcon(s(i,!0)),p.current?p.current.zoomToShowLayer(e,()=>{r.setView(a,16),e.isPopupOpen()||e.openPopup()}):(r.setView(a,16),e.isPopupOpen()||e.openPopup())}Object.values(y.current).forEach(o=>{if(o!==e){let e=t.find(e=>y.current[e.id]===o);if(e){let t=x[e.category],r=(null==t?void 0:t.color)||c;o.options.icon&&o.options.icon.options.className.includes("selected-marker-icon")&&o.setIcon(s(r,!1))}}})},[o,g,x,t]),(0,r.jsx)("div",{ref:u,className:"w-full h-full"})}}}]);